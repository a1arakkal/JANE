<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit JANE — JANE • JANE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit JANE — JANE"><meta name="description" content="Fit a latent space cluster model, with or without noise edges, using an EM algorithm."><meta property="og:description" content="Fit a latent space cluster model, with or without noise edges, using an EM algorithm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JANE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/JANE-User-Guide.html">JANE User Guide</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/blob/HEAD/NEWS.md" target="_blank">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit JANE</h1>
      <small class="dont-index">Source: <a href="https://github.com/a1arakkal/JANE/blob/master/R/JANE.R" class="external-link"><code>R/JANE.R</code></a></small>
      <div class="d-none name"><code>JANE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a latent space cluster model, with or without noise edges, using an EM algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">JANE</span><span class="op">(</span></span>
<span>  <span class="va">A</span>,</span>
<span>  D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"bernoulli"</span>,</span>
<span>  noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  guess_noise_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>  case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  DA_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>A square matrix or sparse matrix of class 'Matrix' (from the Matrix package) representing the adjacency matrix of the network of interest.</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Integer (scalar or vector) specifying the dimension of the latent space (default is 2).</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Integer (scalar or vector) specifying the number of clusters to consider (default is 2).</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the distribution of the edge weights.</p><ul><li><p>'bernoulli': Expects an <strong>unweighted</strong> network; utilizes a Bernoulli distribution with a logit link (default)</p></li>
<li><p>'lognormal': Expects a <strong>weighted</strong> network with positive, non-zero, continuous edge weights; utilizes a log-normal distribution with an identity link</p></li>
<li><p>'poisson': Expects a <strong>weighted</strong> network with edge weights representing non-zero counts; utilizes a zero-truncated Poisson distribution with a log link</p></li>
</ul></dd>


<dt id="arg-noise-weights">noise_weights<a class="anchor" aria-label="anchor" href="#arg-noise-weights"></a></dt>
<dd><p>A logical; if <code>TRUE</code> then a Hurdle model is used to account for noise weights, if <code>FALSE</code> simply utilizes the supplied network (converted to an unweighted binary network if a weighted network is supplied, i.e., (A &gt; 0.0)*1.0) and fits a latent space cluster model (default is <code>FALSE</code>).</p></dd>


<dt id="arg-guess-noise-weights">guess_noise_weights<a class="anchor" aria-label="anchor" href="#arg-guess-noise-weights"></a></dt>
<dd><p>Only applicable if <code>noise_weights = TRUE</code>. A numeric value specifying the best guess for the mean of the noise weight distribution for <code>family %in% c('lognormal', 'poisson')</code> (mean is on the log-scale for lognormal) <strong>OR</strong> proportion (i.e. in (0,1)) of all edges that are noise edges for <code>family = 'bernoulli'</code>. If <code>NULL</code> (i.e., default) and <code>noise_weights = TRUE</code> then the 1st percentile of the non-zero weights will be used for <code>family %in% c('lognormal', 'poisson')</code> and 1% will be used for <code>family = 'bernoulli'</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character string specifying the model to fit:</p><ul><li><p>'NDH': <strong>undirected</strong> network with no degree heterogeneity (or connection strength heterogeneity if working with weighted network)</p></li>
<li><p>'RS': <strong>undirected</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network)</p></li>
<li><p>'RSR': <strong>directed</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network)</p></li>
</ul></dd>


<dt id="arg-initialization">initialization<a class="anchor" aria-label="anchor" href="#arg-initialization"></a></dt>
<dd><p>A character string or a list to specify the initial values for the EM algorithm:</p><ul><li><p>'GNN': uses a type of graphical neural network approach to generate initial values (default)</p></li>
<li><p>'random': uses random initial values</p></li>
<li><p>A user-supplied list of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> "<code>JANE.initial_values</code>" representing initial values for the EM algorithm. See <code><a href="specify_initial_values.html">specify_initial_values</a></code> for details on how to specify initial values</p></li>
</ul></dd>


<dt id="arg-case-control">case_control<a class="anchor" aria-label="anchor" href="#arg-case-control"></a></dt>
<dd><p>A logical; if <code>TRUE</code> then uses a case-control approximation approach (default is <code>FALSE</code>).</p></dd>


<dt id="arg-da-type">DA_type<a class="anchor" aria-label="anchor" href="#arg-da-type"></a></dt>
<dd><p>(Experimental) A character string to specify the type of deterministic annealing approach to use</p><ul><li><p>'none': does not employ a deterministic annealing approach (default)</p></li>
<li><p>'cooling': (Experimental) employs a traditional deterministic annealing approach where temperature decreases</p></li>
<li><p>'heating': (Experimental) employs a deterministic anti-annealing approach where temperature increases</p></li>
<li><p>'hybrid': (Experimental) employs a combination of the 'cooling' and 'heating' approach</p></li>
</ul></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>(optional) An integer value to specify the seed for reproducibility.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters. See 'Details'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> "<code>JANE</code>" containing the following components:</p>
<dl><dt><code>input_params</code></dt>
<dd><p>A list containing the input parameters for <code>IC_selection</code>, <code>case_control</code>, <code>DA_type</code>, <code>model</code>, <code>family</code>, and <code>noise_weights</code> used in the function call.</p></dd>

<dt><code>A</code></dt>
<dd><p>The square sparse adjacency matrix of class 'dgCMatrix' used in fitting the latent space cluster model. This matrix can be different than the input A matrix as isolates are removed.</p></dd>

<dt><code>IC_out</code></dt>
<dd><p>A matrix containing the relevant information criteria for all combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> considered. The 'selected' column indicates the chosen optimal fit.</p></dd>

<dt><code>all_convergence_ind</code></dt>
<dd><p>A matrix containing the convergence information (i.e., 1 = converged, 0 = did not converge) and number of iterations for all combinations of <code>K</code>, <code>D</code>, <code>n_start</code>, and <code>beta_temperature</code> considered.</p></dd>

<dt><code>optimal_res</code></dt>
<dd><p>A list containing the estimated parameters of interest based on the optimal fit selected. It is recommended to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to extract the parameters of interest. See <code><a href="summary.JANE.html">summary.JANE</a></code> for more details.</p></dd>

<dt><code>optimal_starting</code></dt>
<dd><p>A list of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> "<code>JANE.initial_values</code>" containing the starting parameters used in the EM algorithm that resulted in the optimal fit selected. It is recommended to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to extract the parameters of interest. See <code><a href="summary.JANE.html">summary.JANE</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Isolates are removed from the adjacency matrix A. If an unsymmetric adjacency matrix A is supplied for <code>model %in% c('NDH', 'RS')</code> the user will be asked if they would like to proceed with converting A to a symmetric matrix (i.e., <code>A &lt;- 1.0 * ( (A + t(A)) &gt; 0.0 )</code>); only able to do so if <code>family = 'bernoulli'</code>. Additionally, if a weighted network is supplied and <code>noise_weights = FALSE</code>, then the network will be converted to an unweighted binary network (i.e., (A &gt; 0.0)*1.0) and a latent space cluster model is fit.</p>
<p><strong><code>control</code>:</strong></p>
<p>The <code>control</code> argument is a named list that the user can supply containing the following components:</p><dl><dt><code>verbose</code></dt>
<dd><p>A logical; if <code>TRUE</code> causes additional information to be printed out about the progress of the EM algorithm (default is <code>FALSE</code>).</p></dd>

<dt><code>max_its</code></dt>
<dd><p>An integer specifying the maximum number of iterations for the EM algorithm (default is <code>1e3</code>).</p></dd>

<dt><code>min_its</code></dt>
<dd><p>An integer specifying the minimum number of iterations for the EM algorithm (default is <code>10</code>).</p></dd>

<dt><code>priors</code></dt>
<dd><p>A list of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> "<code>JANE.priors</code>" representing prior hyperparameter specifications (default is <code>NULL</code>). See <code><a href="specify_priors.html">specify_priors</a></code> for details on how to specify the hyperparameters.</p></dd>

<dt><code>n_interior_knots</code></dt>
<dd><p>(only relevant for <code>model %in% c('RS', 'RSR')</code>) An integer specifying the number of interior knots used in fitting a natural cubic spline for degree heterogeneity (and connection strength heterogeneity if working with weighted network) models (default is <code>5</code>).</p></dd>

<dt><code>termination_rule</code></dt>
<dd><p>A character string to specify the termination rule to determine the convergence of the EM algorithm:</p><ul><li><p><code>'prob_mat'</code>: uses change in the absolute difference in \(\hat{Z}^{U}\) (i.e., the \(N \times K\) cluster membership probability matrix) between subsequent iterations (default)</p></li>
<li><p><code>'Q'</code>: uses change in the absolute difference in the objective function of the E-step evaluated using parameters from subsequent iterations</p></li>
<li><p><code>'ARI'</code>: comparing the classifications between subsequent iterations using adjusted Rand index</p></li>
<li><p><code>'NMI'</code>: comparing the classifications between subsequent iterations using normalized mutual information</p></li>
<li><p><code>'CER'</code>: comparing the classifications between subsequent iterations using classification error rate</p></li>
</ul></dd>

<dt><code>tolerance</code></dt>
<dd><p>A numeric specifying the tolerance used for <code>termination_rule %in% c('Q', 'prob_mat')</code> (default is <code>1e-3</code>).</p></dd>

<dt><code>tolerance_ARI</code></dt>
<dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'ARI'</code> (default is <code>0.999</code>).</p></dd>

<dt><code>tolerance_NMI</code></dt>
<dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'NMI'</code> (default is <code>0.999</code>).</p></dd>

<dt><code>tolerance_CER</code></dt>
<dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'CER'</code> (default is <code>0.01</code>).</p></dd>

<dt><code>n_its_start_CA</code></dt>
<dd><p>An integer specifying what iteration to start computing the change in cumulative averages (note: the change in the cumulative average of \(\hat{U}\), the latent position matrix, is not tracked when <code>termination_rule = 'Q'</code>) (default is <code>20</code>).</p></dd>

<dt><code>tolerance_diff_CA</code></dt>
<dd><p>A numeric specifying the tolerance used for the change in cumulative average of <code>termination_rule</code> metric and \(\hat{U}\) (note: the change in the cumulative average of \(\hat{U}\) is not tracked when <code>termination_rule = 'Q'</code>) (default is <code>1e-3</code>).</p></dd>

<dt><code>consecutive_diff_CA</code></dt>
<dd><p>An integer specifying the tolerance for the number of consecutive instances where the change in cumulative average is less than <code>tolerance_diff_CA</code> (default is <code>5</code>).</p></dd>

<dt><code>quantile_diff</code></dt>
<dd><p>A numeric in <code>[0,1]</code> specifying the quantile used in computing the change in the absolute difference of \(\hat{Z}^{U}\) and \(\hat{U}\) between subsequent iterations (default is <code>1</code>, i.e., max).</p></dd>

<dt><code>beta_temp_schedule</code></dt>
<dd><p>(Experimental) A numeric vector specifying the temperature schedule for deterministic annealing (default is <code>1</code>, i.e., deterministic annealing not utilized).</p></dd>

<dt><code>n_control</code></dt>
<dd><p>An integer specifying the fixed number of controls (i.e., non-links) sampled for each actor; only relevant when <code>case_control = TRUE</code> (default is <code>100</code> when <code>case_control = TRUE</code> and <code>NULL</code> when <code>case_control = FALSE</code>).</p></dd>

<dt><code>n_start</code></dt>
<dd><p>An integer specifying the maximum number of starts for the EM algorithm (default is <code>5</code>).</p></dd>

<dt><code>max_retry</code></dt>
<dd><p>An integer specifying the maximum number of re-attempts if starting values cause issues with EM algorithm (default is <code>5</code>).</p></dd>

<dt><code>IC_selection</code></dt>
<dd><p>A character string to specify the information criteria used to select the optimal fit based on the combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> considered:</p><ul><li><p><code>'BIC_model'</code>: BIC computed from logistic regression or Hurdle model component</p></li>
<li><p><code>'BIC_mbc'</code>: BIC computed from model based clustering component</p></li>
<li><p><code>'ICL_mbc'</code>: ICL computed from model based clustering component</p></li>
<li><p><code>'Total_BIC'</code>: sum of <code>'BIC_model'</code> and <code>'BIC_mbc'</code></p></li>
<li><p><code>'Total_ICL'</code>: sum of <code>'BIC_model'</code> and <code>'ICL_mbc'</code> (default)</p></li>
</ul></dd>

<dt><code>sd_random_U_GNN</code></dt>
<dd><p>(only relevant when <code>initialization = 'GNN'</code>) A positive numeric value specifying the standard deviation for the random draws from a normal distribution to initialize \(U\) (default is <code>1</code>).</p></dd>

<dt><code>max_retry_GNN</code></dt>
<dd><p>(only relevant when <code>initialization = 'GNN'</code>) An integer specifying the maximum number of re-attempts for the <code>GNN</code> approach before switching to random starting values (default is <code>10</code>).</p></dd>

<dt><code>n_its_GNN</code></dt>
<dd><p>(only relevant when <code>initialization = 'GNN'</code>) An integer specifying the maximum number of iterations for the <code>GNN</code> approach (default is <code>10</code>).</p></dd>

<dt><code>downsampling_GNN</code></dt>
<dd><p>(only relevant when <code>initialization = 'GNN'</code>) A logical; if <code>TRUE</code> employs downsampling s.t. the number of links and non-links are balanced for the <code>GNN</code> approach (default is <code>TRUE</code>).</p></dd>


</dl><p><strong>Running <code>JANE</code> in parallel:</strong></p>
<p><code>JANE</code> integrates the <span class="pkg">future</span> and <span class="pkg">future.apply</span> packages to fit the various combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> in parallel. The 'Examples' section below provides an example of how to run <code>JANE</code> in parallel. See <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></code> and <code><a href="https://future.apply.futureverse.org/reference/future.apply.html" class="external-link">future.apply</a></code> for more details.</p>
<p><strong>Choosing the number of clusters:</strong></p>
<p><code>JANE</code> allows for the following model selection criteria to choose the number of clusters (smaller values are favored):</p><ul><li><p><code>'BIC_model'</code>: BIC computed from logistic regression or Hurdle model component</p></li>
<li><p><code>'BIC_mbc'</code>: BIC computed from model based clustering component</p></li>
<li><p><code>'ICL_mbc'</code>: ICL (Biernacki et al. (2000)) computed from model based clustering component</p></li>
<li><p><code>'Total_BIC'</code>: Sum of <code>'BIC_model'</code> and <code>'BIC_mbc'</code>, this is the model selection criterion proposed by Handcock et al. (2007)</p></li>
<li><p><code>'Total_ICL'</code>: (default) sum of <code>'BIC_model'</code> and <code>'ICL_mbc'</code>, this criterion is similar to <code>'Total_BIC'</code>, but uses ICL for the model based clustering component, which tends to favor more well-separated clusters.</p></li>
</ul><p>Based on simulation studies, Biernacki et al. (2000) recommends that when the interest in mixture modeling is cluster analysis, instead of density estimation, the \(ICL_{mbc}\) criterion should be favored over the \(BIC_{mbc}\) criterion, as the \(BIC_{mbc}\) criterion tends to overestimate the number of clusters. The \(BIC_{mbc}\) criterion is designed to choose the number of components in a mixture model rather than the number of clusters.</p>
<p><em>Warning</em>: It is not certain whether it is appropriate to use the model selection criterion above to select <code>D</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Biernacki, C., Celeux, G., Govaert, G., 2000. Assessing a mixture model for clustering with the integrated completed likelihood. IEEE Transactions on Pattern Analysis and Machine Intelligence 22, 719–725.</p>
<p>Handcock, M.S., Raftery, A.E., Tantrum, J.M., 2007. Model-based clustering for social networks. Journal of the Royal Statistical Society Series A: Statistics in Society 170, 301–354.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span><span class="co"># Simulate network</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu"><a href="sim_A.html">sim_A</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>                        model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                        mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>                        omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>                        p <span class="op">=</span> <span class="va">p</span>, </span>
<span>                        params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>,</span>
<span>                        remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                        </span>
<span><span class="co"># Run JANE on simulated data</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                  D <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                  K <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>                  initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                  model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                  case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run JANE on simulated data - consider multiple D and K</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                  D <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>                  K <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                  initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                  model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                  case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>                  </span>
<span><span class="co"># Run JANE on simulated data - parallel with 5 cores (NOT RUN)</span></span>
<span><span class="co"># future::plan(future::multisession, workers = 5)</span></span>
<span><span class="co"># res &lt;- JANE::JANE(A = sim_data$A,</span></span>
<span><span class="co">#                   D = 2L,</span></span>
<span><span class="co">#                   K = 3L,</span></span>
<span><span class="co">#                   initialization = "GNN", </span></span>
<span><span class="co">#                   model = "NDH",</span></span>
<span><span class="co">#                   case_control = FALSE,</span></span>
<span><span class="co">#                   DA_type = "none")</span></span>
<span><span class="co"># future::plan(future::sequential)</span></span>
<span></span>
<span><span class="co"># Run JANE on simulated data - case/control approach with 20 controls sampled for each actor</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                  D <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                  K <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>                  initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                  model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                  case_control <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  DA_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_control <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span>                   </span>
<span><span class="co"># Reproducibility</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                   D <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                   K <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>                   initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                   seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                   model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                   case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                   D <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                   K <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>                   initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                   seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                   model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                   case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co">## Check if results match</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">res1</span>, <span class="va">res2</span><span class="op">)</span>    </span>
<span></span>
<span><span class="co"># Another reproducibility example where the seed was not set. </span></span>
<span><span class="co"># It is possible to replicate the results using the starting values due to </span></span>
<span><span class="co"># the nature of EM algorithms</span></span>
<span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                   D <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                   K <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>                   initialization <span class="op">=</span> <span class="st">"GNN"</span>, </span>
<span>                   model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                   case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">## Extract starting values                    </span></span>
<span><span class="va">start_vals</span> <span class="op">&lt;-</span> <span class="va">res3</span><span class="op">$</span><span class="va">optimal_start</span></span>
<span></span>
<span><span class="co">## Run JANE using extracted starting values, no need to specify D and K </span></span>
<span><span class="co">## below as function will determine those values from start_vals</span></span>
<span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu">JANE</span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                   initialization <span class="op">=</span> <span class="va">start_vals</span>, </span>
<span>                   model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                   case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   DA_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>                   </span>
<span><span class="co">## Check if optimal_res are identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">optimal_res</span>, <span class="va">res4</span><span class="op">$</span><span class="va">optimal_res</span><span class="op">)</span>                   </span>
<span><span class="co"># }                            </span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alan Arakkal, Daniel Sewell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

