<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Specify prior hyperparameters for EM algorithm — specify_priors • JANE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specify prior hyperparameters for EM algorithm — specify_priors"><meta name="description" content="A function that allows the user to specify the prior hyperparameters for the EM algorithm in a structure accepted by JANE."><meta property="og:description" content="A function that allows the user to specify the prior hyperparameters for the EM algorithm in a structure accepted by JANE."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JANE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/JANE-User-Guide.html">JANE User Guide</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/blob/HEAD/NEWS.md" target="_blank">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Specify prior hyperparameters for EM algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/a1arakkal/JANE/blob/v2.1.0/R/specify_priors.R" class="external-link"><code>R/specify_priors.R</code></a></small>
      <div class="d-none name"><code>specify_priors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function that allows the user to specify the prior hyperparameters for the EM algorithm in a structure accepted by <code><a href="JANE.html">JANE</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">specify_priors</span><span class="op">(</span></span>
<span>  D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"bernoulli"</span>,</span>
<span>  noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_interior_knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">c</span>,</span>
<span>  <span class="va">G</span>,</span>
<span>  <span class="va">nu</span>,</span>
<span>  <span class="va">e</span>,</span>
<span>  <span class="va">f</span>,</span>
<span>  <span class="va">h</span>,</span>
<span>  <span class="va">l</span>,</span>
<span>  <span class="va">e_2</span>,</span>
<span>  <span class="va">f_2</span>,</span>
<span>  <span class="va">m_1</span>,</span>
<span>  <span class="va">o_1</span>,</span>
<span>  <span class="va">m_2</span>,</span>
<span>  <span class="va">o_2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>An integer specifying the dimension of the latent positions (default is 2).</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>An integer specifying the total number of clusters (default is 2).</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character string specifying the model:</p><ul><li><p>'NDH': <strong>undirected</strong> network with no degree heterogeneity (or connection strength heterogeneity if working with weighted network)</p></li>
<li><p>'RS': <strong>undirected</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network)</p></li>
<li><p>'RSR': <strong>directed</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network)</p></li>
</ul></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the distribution of the edge weights.</p><ul><li><p>'bernoulli': for <strong>unweighted</strong> networks; utilizes a Bernoulli distribution with a logit link (default)</p></li>
<li><p>'lognormal': for <strong>weighted</strong> networks with positive, non-zero, continuous edge weights; utilizes a log-normal distribution with an identity link</p></li>
<li><p>'poisson': for <strong>weighted</strong> networks with edge weights representing non-zero counts; utilizes a zero-truncated Poisson distribution with a log link</p></li>
</ul></dd>


<dt id="arg-noise-weights">noise_weights<a class="anchor" aria-label="anchor" href="#arg-noise-weights"></a></dt>
<dd><p>A logical; if TRUE then a Hurdle model is used to account for noise weights, if FALSE simply utilizes the supplied network (converted to an unweighted binary network if a weighted network is supplied, i.e., (A &gt; 0.0)*1.0) and fits a latent space cluster model (default is FALSE).</p></dd>


<dt id="arg-n-interior-knots">n_interior_knots<a class="anchor" aria-label="anchor" href="#arg-n-interior-knots"></a></dt>
<dd><p>An integer specifying the number of interior knots used in fitting a natural cubic spline for degree heterogeneity (and connection strength heterogeneity if working with weighted network) models (i.e., 'RS' and 'RSR' only; default is <code>NULL</code>).</p></dd>


<dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>A numeric vector of length \(D\) specifying the mean of the multivariate normal prior on \(\mu_k\) for \(k = 1,\ldots,K\), where \(\mu_k\) represents the mean of the multivariate normal distribution for the latent positions of the \(k^{th}\) cluster.</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>A strictly positive numeric scalar specifying the scaling factor on the precision of the multivariate normal prior on \(\mu_k\) for \(k = 1,\ldots,K\), where \(\mu_k\) represents the mean of the multivariate normal distribution for the latent positions of the \(k^{th}\) cluster.</p></dd>


<dt id="arg-c">c<a class="anchor" aria-label="anchor" href="#arg-c"></a></dt>
<dd><p>A positive numeric scalar \(&gt; D\) specifying the degrees of freedom of the Wishart prior on \(\Omega_k\) for \(k = 1,\ldots,K\), where \(\Omega_k\) represents the precision of the multivariate normal distribution for the latent positions of the \(k^{th}\) cluster.</p></dd>


<dt id="arg-g">G<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>A numeric positive definite \(D \times D\) matrix specifying the inverse of the scale matrix of the Wishart prior on \(\Omega_k\) for \(k = 1,\ldots,K\), where \(\Omega_k\) represents the precision of the multivariate normal distribution for the latent positions of the \(k^{th}\) cluster.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>A positive numeric vector of length \(K\) with elements \(\ge 1\) specifying the concentration parameters of the Dirichlet prior on \(p\), where \(p\) represents the mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>A numeric vector of length <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the mean of the multivariate normal prior on \(\beta_{LR}\), where \(\beta_{LR}\) represents the coefficients of the logistic regression model.</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>A numeric positive definite square matrix of dimension <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the precision of the multivariate normal prior on \(\beta_{LR}\), where \(\beta_{LR}\) represents the coefficients of the logistic regression model.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>A positive numeric scalar \(\ge 1\) specifying the first shape parameter for the Beta prior on \(q\), where \(q\) is the proportion of non-edges in the "true" underlying network converted to noise edges. Only relevant when <code>noise_weights = TRUE</code>.</p></dd>


<dt id="arg-l">l<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>A strictly positive numeric scalar specifying the second shape parameter for the Beta prior on \(q\), where \(q\) is the proportion of non-edges in the "true" underlying network converted to noise edges. Only relevant when <code>noise_weights = TRUE</code>.</p></dd>


<dt id="arg-e-">e_2<a class="anchor" aria-label="anchor" href="#arg-e-"></a></dt>
<dd><p>A numeric vector of length <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the mean of the multivariate normal prior on \(\beta_{GLM}\), where \(\beta_{GLM}\) represents the coefficients of the zero-truncated Poisson or log-normal GLM. Only relevant when <code>noise_weights = TRUE &amp; family != 'bernoulli'</code>.</p></dd>


<dt id="arg-f-">f_2<a class="anchor" aria-label="anchor" href="#arg-f-"></a></dt>
<dd><p>A numeric positive definite square matrix of dimension <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the precision of the multivariate normal prior on \(\beta_{GLM}\), where \(\beta_{GLM}\) represents the coefficients of the zero-truncated Poisson or log-normal GLM. Only relevant when <code>noise_weights = TRUE &amp; family != 'bernoulli'</code>.</p></dd>


<dt id="arg-m-">m_1<a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>A positive numeric scalar \(&gt; 1\) specifying the shape parameter for the Gamma prior on \(\tau^2_{weights}\), where \(\tau^2_{weights}\) is the precision (on the log scale) of the log-normal weight distribution. Note, this value is scaled by 0.5, see 'Details'. Only relevant when <code>noise_weights = TRUE &amp; family = 'lognormal'</code>.</p></dd>


<dt id="arg-o-">o_1<a class="anchor" aria-label="anchor" href="#arg-o-"></a></dt>
<dd><p>A positive numeric scalar \(&gt; 0\) specifying the rate parameter for the Gamma prior on \(\tau^2_{weights}\), where \(\tau^2_{weights}\) is the precision (on the log scale) of the log-normal weight distribution. Note, this value is scaled by 0.5, see 'Details'. Only relevant when <code>noise_weights = TRUE &amp; family = 'lognormal'</code>.</p></dd>


<dt id="arg-m-">m_2<a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>A positive numeric scalar \(\ge 2\) specifying the shape parameter for the Gamma prior on \(\tau^2_{noise \ weights}\), where \(\tau^2_{noise \ weights}\) is the precision (on the log scale) of the log-normal noise weight distribution. Note, this value is scaled by 0.5, see 'Details'. Only relevant when <code>noise_weights = TRUE &amp; family = 'lognormal'</code>.</p></dd>


<dt id="arg-o-">o_2<a class="anchor" aria-label="anchor" href="#arg-o-"></a></dt>
<dd><p>A positive numeric scalar \(&gt; 0\) specifying the rate parameter for the Gamma prior on \(\tau^2_{noise \ weights}\), where \(\tau^2_{noise \ weights}\) is the precision (on the log scale) of the log-normal noise weight distribution. Note, this value is scaled by 0.5, see 'Details'. Only relevant when <code>noise_weights = TRUE &amp; family = 'lognormal'</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> "<code>JANE.priors</code>" representing prior hyperparameters for the EM algorithm, in a structure accepted by <code>JANE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Prior on \(\boldsymbol{\mu}_k\) and \(\boldsymbol{\Omega}_k\)</strong> (note: the same prior is used for \(k = 1,\ldots,K\)) :</p>
<p>$$\boldsymbol{\Omega}_k \sim Wishart(c, \boldsymbol{G}^{-1})$$
$$\boldsymbol{\mu}_k | \boldsymbol{\Omega}_k \sim MVN(\boldsymbol{a}, (b\boldsymbol{\Omega}_k)^{-1})$$</p>
<p><strong>Prior on \(\boldsymbol{p}\)</strong>:</p>
<p>For the current implementation we require that all elements of the <code>nu</code> vector be \(\ge 1\) to prevent against negative mixture weights for empty clusters.
$$\boldsymbol{p} \sim Dirichlet(\nu_1 ,\ldots,\nu_K)$$</p>
<p><strong>Prior on \(\boldsymbol{\beta}_{LR}\)</strong>:
$$\boldsymbol{\beta}_{LR} \sim MVN(\boldsymbol{e}, \boldsymbol{F}^{-1})$$</p>
<p><strong>Prior on \(q\)</strong>:
$$q \sim Beta(h, l)$$</p>
<p><strong><em>Zero-truncated Poisson</em></strong></p>
<p><strong>Prior on \(\boldsymbol{\beta}_{GLM}\)</strong>:
$$\boldsymbol{\beta}_{GLM} \sim MVN(\boldsymbol{e}_{2}, \boldsymbol{F}_{2}^{-1})$$</p>
<p><strong><em>Log-normal</em></strong></p>
<p><strong>Prior on \(\tau^2_{weights}\)</strong>:
$$\tau^2_{weights} \sim Gamma(\frac{m_1}{2}, \frac{o_1}{2})$$</p>
<p><strong>Prior on \(\boldsymbol{\beta}_{GLM}\)</strong>:
$$\boldsymbol{\beta}_{GLM}|\tau^2_{weights} \sim MVN(\boldsymbol{e}_{2}, (\tau^2_{weights}\boldsymbol{F}_{2})^{-1})$$</p>
<p><strong>Prior on \(\tau^2_{noise \ weights}\)</strong>:
$$\tau^2_{noise \ weights} \sim Gamma(\frac{m_2}{2}, \frac{o_2}{2})$$</p>
<p>Unevaluated calls can be supplied as values for specific hyperparameters. This is particularly useful when running <code>JANE</code> for multiple combinations of <code>K</code> and <code>D</code>. See 'examples' section below for implementation examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span><span class="co"># Simulate network</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu"><a href="sim_A.html">sim_A</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>                        model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                        mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>                        omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>                        p <span class="op">=</span> <span class="va">p</span>, </span>
<span>                        params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>, </span>
<span>                        remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                        </span>
<span>                        </span>
<span><span class="co"># Specify prior hyperparameters</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">3L</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_prior_hyperparameters</span> <span class="op">&lt;-</span> <span class="fu">specify_priors</span><span class="op">(</span>D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                                           K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                                           model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                           n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                           a <span class="op">=</span> <span class="va">a</span>,</span>
<span>                                           b <span class="op">=</span> <span class="va">b</span>,</span>
<span>                                           c <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                           G <span class="op">=</span> <span class="va">G</span>,</span>
<span>                                           nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>                                           e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                           f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span>                                           </span>
<span><span class="co"># Run JANE on simulated data using supplied prior hyperparameters</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">JANE</span><span class="fu">::</span><span class="fu"><a href="JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                  D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                  K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                  initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>                  model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                  case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  DA_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">my_prior_hyperparameters</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify prior hyperparameters as unevaluated calls</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_prior_hyperparameters</span> <span class="op">&lt;-</span> <span class="fu">specify_priors</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                           n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                           a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           b <span class="op">=</span> <span class="va">b</span>,</span>
<span>                                           c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">D</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                           G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                           f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span>                                           </span>
<span><span class="co"># # Run JANE on simulated data using supplied prior hyperparameters (NOT RUN)</span></span>
<span><span class="co"># future::plan(future::multisession, workers = 5)</span></span>
<span><span class="co"># res &lt;- JANE::JANE(A = sim_data$A,</span></span>
<span><span class="co">#                    D = 2:5,</span></span>
<span><span class="co">#                    K = 2:10,</span></span>
<span><span class="co">#                    initialization = "GNN",</span></span>
<span><span class="co">#                    model = "RS",</span></span>
<span><span class="co">#                    case_control = FALSE,</span></span>
<span><span class="co">#                    DA_type = "none",</span></span>
<span><span class="co">#                    control = list(priors = my_prior_hyperparameters))</span></span>
<span><span class="co"># future::plan(future::sequential)</span></span>
<span>                </span>
<span>                                                         </span>
<span><span class="co"># }</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alan Arakkal, Daniel Sewell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

