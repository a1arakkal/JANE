<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate unweighted or weighted networks, with or without noise edges, from latent space cluster models — sim_A • JANE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate unweighted or weighted networks, with or without noise edges, from latent space cluster models — sim_A"><meta name="description" content="Simulate an unweighted or weighted network, with or without noise edges, from a \(D\)-dimensional latent space cluster model with \(K\) clusters and \(N\) actors. The squared euclidean distance is used (i.e., \(dist(U_i,U_j)^2\)), where \(U_i\) and \(U_j\) are the respective actor's positions in a \(D\)-dimensional social space."><meta property="og:description" content="Simulate an unweighted or weighted network, with or without noise edges, from a \(D\)-dimensional latent space cluster model with \(K\) clusters and \(N\) actors. The squared euclidean distance is used (i.e., \(dist(U_i,U_j)^2\)), where \(U_i\) and \(U_j\) are the respective actor's positions in a \(D\)-dimensional social space."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JANE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/JANE-User-Guide.html">JANE User Guide</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/blob/HEAD/NEWS.md" target="_blank">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate unweighted or weighted networks, with or without noise edges, from latent space cluster models</h1>
      <small class="dont-index">Source: <a href="https://github.com/a1arakkal/JANE/blob/v2.0.0/R/sim_A.R" class="external-link"><code>R/sim_A.R</code></a></small>
      <div class="d-none name"><code>sim_A.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate an unweighted or weighted network, with or without noise edges, from a \(D\)-dimensional latent space cluster model with \(K\) clusters and \(N\) actors. The <em>squared</em> euclidean distance is used (i.e., \(dist(U_i,U_j)^2\)), where \(U_i\) and \(U_j\) are the respective actor's positions in a \(D\)-dimensional social space.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_A</span><span class="op">(</span></span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">mus</span>,</span>
<span>  <span class="va">omegas</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"bernoulli"</span>,</span>
<span>  <span class="va">params_LR</span>,</span>
<span>  params_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  noise_weights_prob <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">mean_noise_weights</span>,</span>
<span>  <span class="va">precision_noise_weights</span>,</span>
<span>  remove_isolates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>An integer specifying the number of actors in the network.</p></dd>


<dt id="arg-mus">mus<a class="anchor" aria-label="anchor" href="#arg-mus"></a></dt>
<dd><p>A numeric \(K \times D\) matrix specifying the mean vectors of the \(K\) \(D\)-variate normal distributions for the latent positions.</p></dd>


<dt id="arg-omegas">omegas<a class="anchor" aria-label="anchor" href="#arg-omegas"></a></dt>
<dd><p>A numeric \(D \times D \times K\) array specifying the precision matrices of the \(K\) \(D\)-variate normal distributions for the latent positions.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A numeric vector of length \(K\) specifying the mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character string specifying the type of model used to simulate the network:</p><ul><li><p>'NDH': generates an <strong>undirected</strong> network with no degree heterogeneity (or connection strength heterogeneity if working with weighted network)</p></li>
<li><p>'RS': generates an <strong>undirected</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network), specifically by including actor specific random sociality effects</p></li>
<li><p>'RSR': generates a <strong>directed</strong> network with degree heterogeneity (and connection strength heterogeneity if working with weighted network), specifically by including actor specific random sender and receiver effects</p></li>
</ul></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the distribution of the edge weights.</p><ul><li><p>'bernoulli': generates an <strong>unweighted</strong> network from a latent space cluster model</p></li>
<li><p>'lognormal': generates a <strong>weighted</strong> network by first simulating an unweighted network using a latent space cluster model, and then assigning edge weights based on a log-normal GLM utilizing an identity link</p></li>
<li><p>'poisson': generates a <strong>weighted</strong> network by first simulating an unweighted network using a latent space cluster model, and then assigning edge weights based on a zero-truncated Poisson GLM utilizing a log link</p></li>
</ul></dd>


<dt id="arg-params-lr">params_LR<a class="anchor" aria-label="anchor" href="#arg-params-lr"></a></dt>
<dd><p>A list containing the parameters of the logistic regression model to simulate the unweighted network, including:</p><ul><li><p>'beta0': a numeric value specifying the intercept parameter for the logistic regression model</p></li>
<li><p>'precision_R_effects': precision parameters for random degree heterogeneity effects, specific to the logistic regression model:
</p><ul><li><p>'NDH': does not apply, can leave as missing</p></li>
<li><p>'RS': a numeric value specifying the precision parameter of the normal distribution of the random sociality effect, if missing will generate from a gamma(shape = 1, rate = 1)</p></li>
<li><p>'RSR': a numeric matrix specifying the precision matrix of the multivariate normal distribution of the random sender and receiver effects, if missing will generate from a Wishart(df = 3, Sigma = \(I_2\))</p></li>
</ul></li>
</ul></dd>


<dt id="arg-params-weights">params_weights<a class="anchor" aria-label="anchor" href="#arg-params-weights"></a></dt>
<dd><p>Only relevant when <code>family %in% c('lognormal', 'poisson')</code>. A list containing the parameters of the GLMs for the edge weights, including:</p><ul><li><p>'beta0': a numeric value specifying the intercept parameter for the zero-truncated Poisson or log-normal GLM</p></li>
<li><p>'precision_R_effects': precision parameters for random connection strength heterogeneity effects, specific to the zero-truncated Poisson or log-normal GLM:
</p><ul><li><p>'NDH': does not apply, can leave as missing</p></li>
<li><p>'RS': a numeric value specifying the precision parameter of the normal distribution of the random sociality effect, if missing will generate from a gamma(shape = 1, rate = 1)</p></li>
<li><p>'RSR': a numeric matrix specifying the precision matrix of the multivariate normal distribution of the random sender and receiver effects, if missing will generate from a Wishart(df = 3, Sigma = \(I_2\))</p></li>
</ul></li>
<li><p>'precision_weights': a positive, non-zero, numeric representing the precision (on the log scale) of the log-normal weight distribution. Only relevant when <code>family = 'lognormal'</code></p></li>
</ul></dd>


<dt id="arg-noise-weights-prob">noise_weights_prob<a class="anchor" aria-label="anchor" href="#arg-noise-weights-prob"></a></dt>
<dd><p>A numeric in [0,1] representing the proportion of all edges in the simulated network that are noise edges (default is 0.0).</p></dd>


<dt id="arg-mean-noise-weights">mean_noise_weights<a class="anchor" aria-label="anchor" href="#arg-mean-noise-weights"></a></dt>
<dd><p>A numeric representing the mean of the noise weight distribution. Only relevant when <code>family %in% c('lognormal', 'poisson')</code> and <code>noise_weights_prob&gt;0.0</code>. For family = 'poisson' value has to be &gt; 0.0, for family = "lognormal" the mean is on the log scale.</p></dd>


<dt id="arg-precision-noise-weights">precision_noise_weights<a class="anchor" aria-label="anchor" href="#arg-precision-noise-weights"></a></dt>
<dd><p>A positive, non-zero, numeric representing the precision (on the log scale) of the log-normal noise weight distribution. Only relevant when <code>family = 'lognormal'</code> and <code>noise_weights_prob&gt;0.0</code>.</p></dd>


<dt id="arg-remove-isolates">remove_isolates<a class="anchor" aria-label="anchor" href="#arg-remove-isolates"></a></dt>
<dd><p>A logical; if <code>TRUE</code> then isolates from the network are removed (default is <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p>
<dl><dt><code>A</code></dt>
<dd><p>A sparse adjacency matrix of class 'dgCMatrix' representing the "true" underlying unweighted network with no noise edges.</p></dd>

<dt><code>W</code></dt>
<dd><p>A sparse adjacency matrix of class 'dgCMatrix' representing the unweighted or weighted network, with or without noise. Note, if <code>family = 'bernoulli'</code> and <code>noise_weights_prob = 0</code>, then <code>A = W</code>.</p></dd>

<dt><code>q_prob</code></dt>
<dd><p>A numeric scalar representing the proportion of non-edges in the "true" underlying network converted to noise edges. See 'Details' for how this value is computed.</p></dd>

<dt><code>Z_U</code></dt>
<dd><p>A numeric \(N \times K\) cluster assignment matrix with rows representing the cluster an actor belongs to (i.e., indicated by a value of 1.0).</p></dd>

<dt><code>Z_W</code></dt>
<dd><p>A numeric \(|E| \times 4\) edge weight cluster assignment matrix, with \(|E|\) representing the total number of edges in the network (for undirected networks, only the upper diagonal edges are retained). The first two columns (i.e., 'i' and 'j') contains the specific indices of the edge between the \(i^{th}\) and \(j^{th}\) actors, the third column (i.e., 'weight') contains the specific edge weight, and the fourth column (i.e., 'Z_W') represents a noise-cluster label, where 1 denotes a non-noise edge and 2 denotes a noise edge. Will be <code>NULL</code> if <code>noise_weights_prob = 0</code>.</p></dd>

<dt><code>U</code></dt>
<dd><p>A numeric \(N \times D\) matrix with rows representing an actor's position in a \(D\)-dimensional social space.</p></dd>

<dt><code>mus</code></dt>
<dd><p>The inputted numeric \(K \times D\) <code>mus</code> matrix.</p></dd>

<dt><code>omegas</code></dt>
<dd><p>The inputted numeric \(D \times D \times K\) <code>omegas</code> array.</p></dd>

<dt><code>p</code></dt>
<dd><p>The inputted numeric vector <code>p</code> of length \(K\).</p></dd>

<dt><code>noise_weights_prob</code></dt>
<dd><p>The inputted numeric scalar <code>noise_weights_prob</code>.</p></dd>

<dt><code>mean_noise_weights</code></dt>
<dd><p>The inputted numeric scalar <code>mean_noise_weights</code>. Will be <code>NULL</code> if <code>noise_weights_prob = 0</code>.</p></dd>

<dt><code>precision_noise_weights</code></dt>
<dd><p>The inputted numeric scalar <code>precision_noise_weights</code>. Will be <code>NULL</code> if <code>noise_weights_prob = 0</code>.</p></dd>

<dt><code>model</code></dt>
<dd><p>The inputted <code>model</code> character string.</p></dd>

<dt><code>family</code></dt>
<dd><p>The inputted <code>family</code> character string.</p></dd>

<dt><code>params_LR</code></dt>
<dd><p>The inputted <code>params_LR</code> list. If <code>model != "NDH"</code>, will have an additional element "RE" containing a numeric \(N \times 1\) matrix representing the actor specific random sociality effect (i.e., s) OR a \(N \times 2\) matrix representing the actor specific random sender and receiver effects (i.e., s and r, respectively).</p></dd>

<dt><code>params_weights</code></dt>
<dd><p>The inputted <code>params_weights</code> list. If <code>model != "NDH"</code>, will have an additional element "RE" containing a numeric \(N \times 1\) matrix representing the actor specific random sociality effect (i.e., s) OR a \(N \times 2\) matrix representing the actor specific random sender and receiver effects (i.e., s and r, respectively).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The returned scalar <code>q_prob</code> represents the proportion of non-edges in the simulated network to be converted to noise edges, computed as \(\frac{p_{noise} \times D_{A}}{(1-D_{A}) \times (1-p_{noise})}\), where \(D_{A}\) is the density of the simulated network without noise and \(p_{noise}\) is the inputted <code>noise_weights_prob</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span></span>
<span><span class="co"># Simulate an undirected, unweighted network, with no noise and no degree heterogeneity</span></span>
<span><span class="fu">JANE</span><span class="fu">::</span><span class="fu">sim_A</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>            model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>            mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>            omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>            p <span class="op">=</span> <span class="va">p</span>, </span>
<span>            params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>,</span>
<span>            remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a directed, weighted network, with degree and strength heterogeneity but no noise</span></span>
<span><span class="fu">JANE</span><span class="fu">::</span><span class="fu">sim_A</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>            model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>            mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>            omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>            p <span class="op">=</span> <span class="va">p</span>, </span>
<span>            params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>,</span>
<span>            params_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                  precision_weights <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>            remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate an undirected, weighted network, with noise and degree and strength heterogeneity</span></span>
<span><span class="fu">JANE</span><span class="fu">::</span><span class="fu">sim_A</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>            model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>            mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>            omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>            p <span class="op">=</span> <span class="va">p</span>, </span>
<span>            params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>,</span>
<span>            params_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>            noise_weights_prob <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>            mean_noise_weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># }</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alan Arakkal, Daniel Sewell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

