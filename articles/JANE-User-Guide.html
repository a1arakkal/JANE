<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>JANE User Guide • JANE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="JANE User Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JANE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/JANE-User-Guide.html">JANE User Guide</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/blob/HEAD/NEWS.md" target="_blank">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/a1arakkal/JANE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>JANE User Guide</h1>
            <h3 data-toc-skip class="subtitle">JANE Package Version
2.1.0</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/a1arakkal/JANE/blob/v2.1.0/vignettes/JANE-User-Guide.Rmd" class="external-link"><code>vignettes/JANE-User-Guide.Rmd</code></a></small>
      <div class="d-none name"><code>JANE-User-Guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p><strong>JANE</strong> is an R package for fitting latent space
network cluster models using an expectation-maximization (EM) algorithm.
It enables flexible modeling of unweighted or weighted network data,
with or without noise edges, and supports both directed and undirected
networks, with or without degree and strength heterogeneity. Designed to
efficiently handle large networks, <strong>JANE</strong> allows users to
explore latent structure, identify actor-centric communities, and
simulate networks with customizable clustering and connectivity
patterns.</p>
<p>Details on the methodology underlying the package can be found in
<span class="citation">Arakkal and Sewell (2025)</span>.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>Fine-tuned algorithm for fast and accurate actor-centric clustering
using latent space models</li>
<li>Supports both weighted and unweighted networks, with or without
noisy edges</li>
<li>Allows for modeling of discrete and continuous edge weights</li>
<li>Multiple initialization strategies for the EM algorithm, including
random initialization, a novel graphical neural network initialization,
and user-specified values</li>
<li>Customizable prior hyperparameter specification</li>
<li>Supports parallel implementation for faster inference using the
<strong>future</strong> and <strong>future.apply</strong> packages <span class="citation">(Bengtsson 2021)</span>
</li>
<li>Supports case-control likelihood approximation for scalable
inference <span class="citation">(Raftery et al. 2012)</span>
</li>
<li>Built-in visualization and summary tools</li>
</ul>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Current release from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"JANE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Development version from GitHub</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"a1arakkal/JANE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Development version with vignettes</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"a1arakkal/JANE"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>Once installed, you can load the package and access its help
documentation using the following commands:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load JANE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://a1arakkal.github.io/JANE/">JANE</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vignette</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/RShowDoc.html" class="external-link">RShowDoc</a></span><span class="op">(</span><span class="st">"JANE-User-Guide"</span>, package <span class="op">=</span> <span class="st">"JANE"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-jane-on-networks-without-noise-edges">Fitting <strong>JANE</strong> on networks <em>without</em> noise
edges<a class="anchor" aria-label="anchor" href="#fitting-jane-on-networks-without-noise-edges"></a>
</h2>
<p>When the <code>noise_weights</code> argument in <code><a href="../reference/JANE.html">JANE()</a></code>
is set to <code>FALSE</code> (default), a standard latent space cluster
model is fit to the supplied <em>unweighted</em> network.</p>
<div class="section level3">
<h3 id="available-models">Available models<a class="anchor" aria-label="anchor" href="#available-models"></a>
</h3>
<div class="section level4">
<h4 id="model-ndh">
<code>model = "NDH"</code><a class="anchor" aria-label="anchor" href="#model-ndh"></a>
</h4>
<p>Applicable for undirected networks and assumes no degree
heterogeneity. However, in real-world networks, it is rare to find no
degree heterogeneity, as most networks exhibit considerable variation in
node connectivity. Below is an example that fits an NDH model,
specifying the dimension of the latent space as 2 and the number of
clusters as 3.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-rs">
<code>model = "RS"</code><a class="anchor" aria-label="anchor" href="#model-rs"></a>
</h4>
<p>Applicable for undirected networks and adjusts for degree
heterogeneity through the inclusion of actor-specific sociality effects.
Below is an example that fits an RS model, where the number of clusters
is specified to be 3 and a range of dimensions between 2 and 5 for the
latent space is considered.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-rsr">
<code>model = "RSR"</code><a class="anchor" aria-label="anchor" href="#model-rsr"></a>
</h4>
<p>Applicable for directed networks and adjusts for degree heterogeneity
through the inclusion of actor-specific sender and receiver effects.
Below is an example that fits an RSR model, where a range of cluster
numbers between 2 and 10 and a range of dimensions between 2 and 5 for
the latent space is considered.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-jane-on-networks-with-noise-edges">Fitting <strong>JANE</strong> on networks <em>with</em> noise
edges<a class="anchor" aria-label="anchor" href="#fitting-jane-on-networks-with-noise-edges"></a>
</h2>
<p>With <code><a href="../reference/JANE.html">JANE()</a></code>, <em>weighted</em> networks are particularly
useful in settings where noise edges are present. In such settings, when
the <code>noise_weights</code> argument in <code><a href="../reference/JANE.html">JANE()</a></code> is set to
<code>TRUE</code>, a latent space hurdle model (LSHM) is fit. The LSHM
leverages information from both the propensity to form an edge and the
observed edge weights to probabilistically down-weight noisy edges,
while preserving edges that are structurally meaningful, subsequently
enhancing community detection.</p>
<p>If the supplied network is a weighted network, in the absence of
noise it can be shown that the latent positions, regression parameters
associated with the logistic regression model, finite mixture model
parameters, and actor-specific cluster membership probabilities can all
be estimated separately from the generalized linear model parameters for
the edge weights. <strong>Thus, when <code>noise_weights = FALSE</code>,
<code><a href="../reference/JANE.html">JANE()</a></code> will simply dichotomize the supplied weighted
network based on a threshold value of 0 and fit a standard latent space
cluster model</strong>.</p>
<div class="section level3">
<h3 id="available-models-1">Available models<a class="anchor" aria-label="anchor" href="#available-models-1"></a>
</h3>
<p>You can fit the <code>"NDH"</code>, <code>"RS"</code>, or
<code>"RSR"</code> models using any of the supported weight
distributions described below. When working with weighted networks, the
<code>"RS"</code> and <code>"RSR"</code> models account not only for
degree heterogeneity but also for strength heterogeneity.</p>
<div class="section level4">
<h4 id="family-poisson">
<code>family = "poisson"</code><a class="anchor" aria-label="anchor" href="#family-poisson"></a>
</h4>
<p>Use this option for count-weighted networks. This setting models
observed edge weights using a zero-truncated Poisson (ZTP)
distribution:</p>
<ul>
<li>Signal edge weights are modeled with a ZTP using a log link</li>
<li>Noise edge weights are modeled with a ZTP using a fixed
user-specified mean via the <code>guess_noise_weights</code>
argument</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>     guess_noise_weights <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="family-lognormal">
<code>family = "lognormal"</code><a class="anchor" aria-label="anchor" href="#family-lognormal"></a>
</h4>
<p>Use this option when edge weights are positive, continuous values.
This setting models observed edge weights using a log-normal
distribution:</p>
<ul>
<li>Signal edges are modeled using a log-normal distribution with an
identity link</li>
<li>Noise edge weights are modeled using a log-normal distribution with
a user-specified log-scale mean via the <code>guess_noise_weights</code>
argument</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     family <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>     guess_noise_weights <span class="op">=</span> <span class="op">-</span><span class="fl">3.5</span><span class="op">)</span> <span class="co"># log-scale mean</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="family-bernoulli-default">
<code>family = "bernoulli"</code> (default)<a class="anchor" aria-label="anchor" href="#family-bernoulli-default"></a>
</h4>
<p>This setting is used for unweighted (binary) networks. In this
case:</p>
<ul>
<li>Signal and noise edges share the same observed weight (i.e., 1), so
only the edge propensity model is used to identify and down-weight
likely noise edges</li>
<li>
<code>guess_noise_weights</code> is interpreted as the expected
proportion of all edges that are likely to be noise</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     family <span class="op">=</span> <span class="st">"bernoulli"</span>,</span>
<span>     guess_noise_weights <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># expected noise edge proportion</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="guess_noise_weights">
<code>guess_noise_weights</code><a class="anchor" aria-label="anchor" href="#guess_noise_weights"></a>
</h3>
<p>If guess_noise_weights is left as NULL (the default),
<code><a href="../reference/JANE.html">JANE()</a></code> will automatically set this value based on the
<code>family</code> argument:</p>
<ul>
<li>For <code>family %in% c("lognormal", "poisson")</code>, the 1st
percentile of the non-zero edge weights is used (log-transformed weights
for <code>lognormal</code>)</li>
<li>For <code>family = "bernoulli"</code>, a default value of 0.01
(i.e., 1%) is used, representing the assumed proportion of noisy
edges</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="simulating-networks">Simulating networks<a class="anchor" aria-label="anchor" href="#simulating-networks"></a>
</h2>
<p><strong>JANE</strong> includes a built-in function,
<code><a href="../reference/sim_A.html">sim_A()</a></code>, for simulating networks with varying clustering
and connectivity patterns. The function returns a list, which includes
the following two components:</p>
<ul>
<li>
<code>A</code>: A sparse adjacency matrix of class ‘dgCMatrix’
representing the “true” underlying unweighted network with no noise
edges</li>
<li>
<code>W</code>: A sparse adjacency matrix of class ‘dgCMatrix’
representing the unweighted or weighted network, with or without noise
edges</li>
</ul>
<p>The relationship between <code>A</code> and <code>W</code> depends on
the values specified for <code>family</code> and
<code>noise_weights_prob</code>:</p>
<ul>
<li>If <code>family = "bernoulli"</code> and
<code>noise_weights_prob = 0</code>, then <code>A</code> and
<code>W</code> are identical (i.e., no noise simulated)</li>
<li>If <code>family = "bernoulli"</code> and
<code>noise_weights_prob &gt; 0</code>, then <code>W</code> contains
added noise edges, while <code>A</code> represents the noise-free
underlying network</li>
<li>If <code>family %in% c("poisson", "lognormal")</code> and
<code>noise_weights_prob = 0</code>, then <code>W</code> contains
continuous or count-valued edge weights, but dichotomizing
<code>W</code> at 0 will reproduce <code>A</code>
</li>
<li>If <code>family %in% c("poisson", "lognormal")</code> and
<code>noise_weights_prob &gt; 0</code>, then <code>W</code> is a noisy,
weighted network with additional spurious edges, and <code>A</code>
remains the true underlying structure</li>
</ul>
<p>Below is an example to simulate an unweighted, undirected, noise-free
network with a 2-dimensional latent space and 3 clusters, assuming no
degree heterogeneity.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the 3 x 2 matrix containing the 1 x 2 mean vectors of the 3 bivariate normals</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 1</span></span>
<span>                 <span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 2</span></span>
<span>                 <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># Mean vector 3</span></span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the 2 x 2 x 3 array containing the 2 x 2 precision matrices of the 3 bivariate normals</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 1</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 2</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Precision matrix 3</span></span>
<span>                  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a network</span></span>
<span><span class="fu"><a href="../reference/sim_A.html">sim_A</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>      model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>      mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>      omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>      p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>      params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>      remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The parameter <code>beta0</code> above can be tuned to achieve a
desired network density:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the 3 x 2 matrix containing the 1 x 2 mean vectors of the 3 bivariate normals</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 1</span></span>
<span>                 <span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 2</span></span>
<span>                 <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># Mean vector 3</span></span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the 2 x 2 x 3 array containing the 2 x 2 precision matrices of the 3 bivariate normals</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 1</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 2</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Precision matrix 3</span></span>
<span>                  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">desired_density</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Target network density</span></span>
<span><span class="va">min_density</span> <span class="op">&lt;-</span> <span class="va">desired_density</span> <span class="op">*</span> <span class="fl">0.99</span>  <span class="co"># Lower bound for acceptable density</span></span>
<span><span class="va">max_density</span> <span class="op">&lt;-</span> <span class="va">desired_density</span> <span class="op">*</span> <span class="fl">1.01</span>  <span class="co"># Upper bound for acceptable density</span></span>
<span><span class="va">n_act</span> <span class="op">&lt;-</span> <span class="fl">100L</span> <span class="co"># Number of actors in the network</span></span>
<span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="cn">Inf</span> <span class="co"># Initialize density to enter while loop</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Initial value for intercept parameter</span></span>
<span><span class="va">n_while_loop</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Counter for outer loop iterations</span></span>
<span><span class="va">max_its</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># Maximum number of iterations</span></span>
<span><span class="va">change_beta0</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># Amount to adjust beta0 by</span></span>
<span></span>
<span><span class="co"># Adjust beta0 until simulated network has the approximate desired density</span></span>
<span><span class="kw">while</span><span class="op">(</span><span class="op">!</span> <span class="op">(</span><span class="va">density</span> <span class="op">&gt;=</span> <span class="va">min_density</span> <span class="op">&amp;</span> <span class="va">density</span> <span class="op">&lt;=</span> <span class="va">max_density</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">n_while_loop</span><span class="op">&gt;</span><span class="va">max_its</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">break</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">n_retry_isolate</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">retry_isolate</span> <span class="op">&lt;-</span> <span class="cn">T</span></span>
<span>  </span>
<span>  <span class="co"># Retry until a network with no isolates is generated (this while loop is optional)</span></span>
<span>  <span class="kw">while</span><span class="op">(</span><span class="va">retry_isolate</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_A.html">sim_A</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">n_act</span>, </span>
<span>                      model <span class="op">=</span> <span class="st">"NDH"</span>,</span>
<span>                      mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>                      omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>                      p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                      params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="va">beta0</span><span class="op">)</span>,</span>
<span>                      remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">n_retry_isolate</span> <span class="op">&lt;-</span> <span class="va">n_retry_isolate</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    </span>
<span>    <span class="co"># Accept network if no isolates remain, or if retried more than 10 times at the same beta0</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">A</span><span class="op">)</span> <span class="op">==</span> <span class="va">n_act</span> <span class="op">|</span> <span class="va">n_retry_isolate</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">retry_isolate</span> <span class="op">&lt;-</span> <span class="cn">F</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Compute network density</span></span>
<span>  <span class="va">density</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph.density.html" class="external-link">graph.density</a></span><span class="op">(</span></span>
<span>    <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">A</span>, mode <span class="op">=</span> <span class="st">"undirected"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Adjust beta0 based on density feedback</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">density</span> <span class="op">&gt;</span> <span class="va">max_density</span><span class="op">)</span>  <span class="op">{</span></span>
<span>    <span class="va">beta0</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">-</span> <span class="va">change_beta0</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">density</span> <span class="op">&lt;</span> <span class="va">min_density</span><span class="op">)</span>  <span class="op">{</span></span>
<span>    <span class="va">beta0</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">change_beta0</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">n_while_loop</span> <span class="op">&lt;-</span> <span class="va">n_while_loop</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  </span>
<span><span class="op">}</span>    </span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">A</span> <span class="co"># Final simulated adjacency matrix</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph.density.html" class="external-link">graph.density</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">A</span>, mode <span class="op">=</span> <span class="st">"undirected"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Verify density</span></span></code></pre></div>
<p>Below is an example that simulates a directed, weighted network with
noise, degree and strength heterogeneity, a 2-dimensional latent space,
and 3 clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the 3 x 2 matrix containing the 1 x 2 mean vectors of the 3 bivariate normals</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 1</span></span>
<span>                 <span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,  <span class="co"># Mean vector 2</span></span>
<span>                 <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># Mean vector 3</span></span>
<span>              nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the 2 x 2 x 3 array containing the 2 x 2 precision matrices of the 3 bivariate normals</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 1</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Precision matrix 2</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Precision matrix 3</span></span>
<span>                  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a network</span></span>
<span><span class="fu"><a href="../reference/sim_A.html">sim_A</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100L</span>, </span>
<span>      model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>      mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>      omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>      p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>      params_LR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      params_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      noise_weights_prob <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>      mean_noise_weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      remove_isolates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-selection-criteria-for-choosing-the-number-of-clusters">Model selection criteria for choosing the number of clusters<a class="anchor" aria-label="anchor" href="#model-selection-criteria-for-choosing-the-number-of-clusters"></a>
</h2>
<p><code><a href="../reference/JANE.html">JANE()</a></code> allows for the following model selection criteria
to choose the number of clusters and the best initialization of the EM
algorithm (smaller values are favored):</p>
<ul>
<li>
<code>"Total_BIC"</code> (i.e., BIC): Sum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{model}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{mbc}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{model}</annotation></semantics></math>
is the BIC computed from logistic regression or Hurdle model component
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{mbc}</annotation></semantics></math>
is the BIC computed from model based clustering component. This is the
model selection criterion proposed by <span class="citation">Handcock,
Raftery, and Tantrum (2007)</span>
</li>
<li>
<code>"Total_ICL"</code> (i.e., BICL): (default) sum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{model}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi><msub><mi>L</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">ICL_{mbc}</annotation></semantics></math>,
this criterion is similar to <code>"Total_BIC"</code>, but uses the
integrated completed likelihood (ICL) for the model based clustering
component, which tends to favor more well-separated clusters</li>
</ul>
<p>Based on simulation studies, <span class="citation">Biernacki,
Celeux, and Govaert (2000)</span> recommends that when the interest in
mixture modeling is cluster analysis, instead of density estimation, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi><msub><mi>L</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">ICL_{mbc}</annotation></semantics></math>
criterion should be favored over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{mbc}</annotation></semantics></math>
criterion, as the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{mbc}</annotation></semantics></math>
criterion tends to overestimate the number of clusters. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><msub><mi>C</mi><mrow><mi>m</mi><mi>b</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BIC_{mbc}</annotation></semantics></math>
criterion is designed to choose the number of components in a mixture
model rather than the number of clusters.</p>
<p><strong><em>Warning</em></strong>: It is not certain whether it is
appropriate to use the model selection criterion above to select the
dimension of the latent space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.</p>
<p>Below is an example that fits an RSR model, where a range of cluster
numbers between 2 and 10 is considered for a 2-dimensional latent space
and <code>"Total_BIC"</code> is used to select the optimal number of
clusters and best initialization of the EM algorithm.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>IC_selection <span class="op">=</span> <span class="st">"Total_BIC"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Below is an example that fits an RSR model for a 2-dimensional latent
space with 3 clusters and <code>"Total_ICL"</code> is used to select the
optimal initialization of the EM algorithm from 10 unique starts. Note:
the number of starts for the EM algorithm is controlled through the
<code>control</code> argument by supplying a value for
<code>n_start</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>IC_selection <span class="op">=</span> <span class="st">"Total_ICL"</span>,</span>
<span>                    n_start <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initialization-of-em-algorithm">Initialization of EM algorithm<a class="anchor" aria-label="anchor" href="#initialization-of-em-algorithm"></a>
</h2>
<p><code><a href="../reference/JANE.html">JANE()</a></code> has three initialization strategies to generate
starting values for the EM algorithm, controlled through the
<code>initialization</code> argument:</p>
<ul>
<li>
<code>"GNN"</code>: uses a type of graphical neural network approach
to generate initial values (default). Details of the graphical neural
network approach can be found in <span class="citation">Arakkal and
Sewell (2025)</span>
</li>
<li>
<code>"random"</code>: uses random initial values</li>
<li>A user-supplied list of S3 class <code>"JANE.initial_values"</code>
representing initial values for the EM algorithm. See
<code><a href="../reference/specify_initial_values.html">?specify_initial_values</a></code> for details on how to specify
initial values</li>
</ul>
<p>Below is an example where starting values are supplied to
<code><a href="../reference/JANE.html">JANE()</a></code> using <code><a href="../reference/specify_initial_values.html">specify_initial_values()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify starting values</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">D</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">N</span>, ncol <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">omegas</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">rWishart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">K</span>, df <span class="op">=</span> <span class="va">D</span><span class="op">+</span><span class="fl">1</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">K</span><span class="op">*</span><span class="va">D</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">K</span>, ncol <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Dirichlet.html" class="external-link">rdirichlet</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span>  <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Dirichlet.html" class="external-link">rdirichlet</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">n_interior_knots</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_starting_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specify_initial_values.html">specify_initial_values</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>                                             D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                                             K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                                             model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>                                             n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                             U <span class="op">=</span> <span class="va">U</span>,</span>
<span>                                             omegas <span class="op">=</span> <span class="va">omegas</span>, </span>
<span>                                             mus <span class="op">=</span> <span class="va">mus</span>, </span>
<span>                                             p <span class="op">=</span> <span class="va">p</span>, </span>
<span>                                             Z <span class="op">=</span> <span class="va">Z</span>,</span>
<span>                                             beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span>         </span>
<span></span>
<span><span class="co"># Run JANE using my_starting_values (no need to specify D and K as function will </span></span>
<span><span class="co"># determine those values from my_starting_values)</span></span>
<span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     initialization <span class="op">=</span> <span class="va">my_starting_values</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specification-of-prior-hyperparameters">Specification of prior hyperparameters<a class="anchor" aria-label="anchor" href="#specification-of-prior-hyperparameters"></a>
</h2>
<div class="section level3">
<h3 id="prior-distributions">Prior distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a>
</h3>
<p>The prior distributions are specified as follows:</p>
<div class="section level4">
<h4 id="prior-on-boldsymbolmu_k-and-boldsymbolomega_k">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛍</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\mu}_k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛀</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Omega}_k</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-boldsymbolmu_k-and-boldsymbolomega_k"></a>
</h4>
<p>The same prior is used for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">k = 1, \ldots, K</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛀</mi><mi>k</mi></msub><mo>∼</mo><mtext mathvariant="normal">Wishart</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>,</mo><msup><mi>𝐆</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{\Omega}_k \sim \text{Wishart}(c, \boldsymbol{G}^{-1})
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛍</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>𝛀</mi><mi>k</mi></msub><mo>∼</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐚</mi><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><msub><mi>𝛀</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{\mu}_k \mid \boldsymbol{\Omega}_k \sim \text{MVN}(\boldsymbol{a}, (b \boldsymbol{\Omega}_k)^{-1})
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="prior-on-boldsymbolp">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐩</mi><annotation encoding="application/x-tex">\boldsymbol{p}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-boldsymbolp"></a>
</h4>
<p>For the current implementation, we require that all elements of the
<code>nu</code> vector be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\geq 1</annotation></semantics></math>
to prevent negative mixture weights for empty clusters:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐩</mi><mo>∼</mo><mtext mathvariant="normal">Dirichlet</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>ν</mi><mi>K</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{p} \sim \text{Dirichlet}(\nu_1, \ldots, \nu_K)
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="prior-on-boldsymbolbeta_lr">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛃</mi><mrow><mi>L</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{LR}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-boldsymbolbeta_lr"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>L</mi><mi>R</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐞</mi><mo>,</mo><msup><mi>𝐅</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{\beta}_{LR} \sim \text{MVN}(\boldsymbol{e}, \boldsymbol{F}^{-1})
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="prior-on-q">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-q"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>∼</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
q \sim \text{Beta}(h, l)
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="zero-truncated-poisson">
<em>Zero-truncated Poisson</em><a class="anchor" aria-label="anchor" href="#zero-truncated-poisson"></a>
</h4>
<div class="section level5">
<h5 id="prior-on-boldsymbolbeta_glm">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{GLM}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-boldsymbolbeta_glm"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐞</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>𝐅</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{\beta}_{GLM} \sim \text{MVN}(\boldsymbol{e}_2, \boldsymbol{F}_2^{-1})
</annotation></semantics></math></p>
</div>
</div>
<div class="section level4">
<h4 id="log-normal">
<em>Log-normal</em><a class="anchor" aria-label="anchor" href="#log-normal"></a>
</h4>
<div class="section level5">
<h5 id="prior-on-tau2_textweights">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mtext mathvariant="normal">weights</mtext><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau^2_{\text{weights}}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-tau2_textweights"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>τ</mi><mtext mathvariant="normal">weights</mtext><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>m</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo>,</mo><mfrac><msub><mi>o</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tau^2_{\text{weights}} \sim \text{Gamma}\left(\frac{m_1}{2}, \frac{o_1}{2}\right)
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="prior-on-boldsymbolbeta_glm-1">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{GLM}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-boldsymbolbeta_glm-1"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><mo>∣</mo><msubsup><mi>τ</mi><mtext mathvariant="normal">weights</mtext><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐞</mi><mn>2</mn></msub><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>τ</mi><mtext mathvariant="normal">weights</mtext><mn>2</mn></msubsup><msub><mi>𝐅</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{\beta}_{GLM} \mid \tau^2_{\text{weights}} \sim \text{MVN}\left(\boldsymbol{e}_2, (\tau^2_{\text{weights}} \boldsymbol{F}_2)^{-1}\right)
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="prior-on-tau2_textnoise-weights">Prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mtext mathvariant="normal">noise weights</mtext><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau^2_{\text{noise weights}}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#prior-on-tau2_textnoise-weights"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>τ</mi><mtext mathvariant="normal">noise weights</mtext><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>m</mi><mn>2</mn></msub><mn>2</mn></mfrac><mo>,</mo><mfrac><msub><mi>o</mi><mn>2</mn></msub><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tau^2_{\text{noise weights}} \sim \text{Gamma}\left(\frac{m_2}{2}, \frac{o_2}{2}\right)
</annotation></semantics></math></p>
</div>
</div>
<div class="section level4">
<h4 id="default-hyperparameters">Default hyperparameters<a class="anchor" aria-label="anchor" href="#default-hyperparameters"></a>
</h4>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐚</mi><mo>=</mo><msub><mn>𝟎</mn><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{a} = \boldsymbol{0}_D</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b = 1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mi>D</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c = D+1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐞</mi><mo>=</mo><msub><mn>𝟎</mn><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>L</mi><mi>R</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{e} = \boldsymbol{0}_{dim(\boldsymbol{\beta}_{LR})}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐞</mi><mn>2</mn></msub><mo>=</mo><msub><mn>𝟎</mn><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{e}_2 = \boldsymbol{0}_{dim(\boldsymbol{\beta}_{GLM})}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐅</mi><mo>=</mo><mtext mathvariant="normal">Diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>100</mn><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msup><mn>2.5</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>L</mi><mi>R</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{F} = \text{Diag}(1/100, (1/2.5^2)\mathbf{1}_{dim(\boldsymbol{\beta}_{LR})-1})</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐅</mi><mn>2</mn></msub><mo>=</mo><mtext mathvariant="normal">Diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>100</mn><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msup><mn>2.5</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{F}_2 = \text{Diag}(1/100, (1/2.5^2)\mathbf{1}_{dim(\boldsymbol{\beta}_{GLM})-1})</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐆</mi><mo>=</mo><msub><mi>𝐈</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{G} = \mathbf{I}_D</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi>l</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h = l =1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub><mo>=</mo><msub><mi>o</mi><mn>1</mn></msub><mo>=</mo><msub><mi>o</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m_1 = m_2 = o_1 = o_2 = 2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛎</mi><mo>=</mo><mn>3</mn><msub><mn>𝟏</mn><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\nu} = 3\mathbf{1}_{K}</annotation></semantics></math></li>
</ul>
<p>where,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
is the dimension of the latent space,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
is the number of clusters,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>L</mi><mi>R</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>d</mi><mi>i</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛃</mi><mrow><mi>G</mi><mi>L</mi><mi>M</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">"NDH”</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>ζ</mi><mo>+</mo><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">"RS”</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn><mi>ζ</mi><mo>+</mo><mn>3</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">"RSR”</mtext><mo>,</mo></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">dim(\boldsymbol{\beta}_{LR}) = dim(\boldsymbol{\beta}_{GLM}) = \begin{cases}1 &amp; \text{"NDH''}\\ \zeta+2 &amp;  \text{"RS''} \\ 2\zeta+3 &amp; \text{"RSR''},\end{cases}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ζ</mi><annotation encoding="application/x-tex">\zeta</annotation></semantics></math>
is the number of interior knots used in fitting a natural cubic spline
for degree heterogeneity (and connection strength heterogeneity if
working with weighted network) models (i.e., <code>"RS"</code> and
<code>"RSR"</code> only).</p>
</div>
</div>
<div class="section level3">
<h3 id="example-of-specifying-hyperparameters-for-a-single-combination-of-k-and-d">Example of specifying hyperparameters for a single combination of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#example-of-specifying-hyperparameters-for-a-single-combination-of-k-and-d"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify prior hyperparameters</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_prior_hyperparameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specify_priors.html">specify_priors</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                                           K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                                           model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                           n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                           a <span class="op">=</span> <span class="va">a</span>,</span>
<span>                                           b <span class="op">=</span> <span class="va">b</span>,</span>
<span>                                           c <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                           G <span class="op">=</span> <span class="va">G</span>,</span>
<span>                                           nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>                                           e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                           f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span>                                           </span>
<span><span class="co"># Run JANE using supplied prior hyperparameters (no need to specify D and K </span></span>
<span><span class="co"># as function will determine those values from my_prior_hyperparameters)</span></span>
<span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">my_prior_hyperparameters</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-of-specifying-hyperparameters-for-multiple-combinations-of-k-and-d">Example of specifying hyperparameters for multiple combinations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#example-of-specifying-hyperparameters-for-multiple-combinations-of-k-and-d"></a>
</h3>
<div class="section level4">
<h4 id="nested-list">Nested list<a class="anchor" aria-label="anchor" href="#nested-list"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify first set of prior hyperparameters</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_prior_hyperparameters_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specify_priors.html">specify_priors</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                                             K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                                             model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                             n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                             a <span class="op">=</span> <span class="va">a</span>,</span>
<span>                                             b <span class="op">=</span> <span class="va">b</span>,</span>
<span>                                             c <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                             G <span class="op">=</span> <span class="va">G</span>,</span>
<span>                                             nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>                                             e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                             f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify second set of prior hyperparameters</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_prior_hyperparameters_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specify_priors.html">specify_priors</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">D</span>,</span>
<span>                                             K <span class="op">=</span> <span class="va">K</span>,</span>
<span>                                             model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                             n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                             a <span class="op">=</span> <span class="va">a</span>,</span>
<span>                                             b <span class="op">=</span> <span class="va">b</span>,</span>
<span>                                             c <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                             G <span class="op">=</span> <span class="va">G</span>,</span>
<span>                                             nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>                                             e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                             f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create nested list</span></span>
<span><span class="va">my_prior_hyperparameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">my_prior_hyperparameters_1</span>,</span>
<span>                                 <span class="va">my_prior_hyperparameters_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run JANE using supplied prior hyperparameters (no need to specify D and K </span></span>
<span><span class="co"># as function will determine those values from my_prior_hyperparameters)</span></span>
<span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">my_prior_hyperparameters</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="unevaluated-calls">Unevaluated calls<a class="anchor" aria-label="anchor" href="#unevaluated-calls"></a>
</h4>
<p>Unevaluated calls using <code><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote()</a></code> can be supplied as
values for specific hyperparameters. This is particularly useful when
running <code><a href="../reference/JANE.html">JANE()</a></code> for multiple combinations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify prior hyperparameters as unevaluated calls</span></span>
<span><span class="va">n_interior_knots</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">n_interior_knots</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_prior_hyperparameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specify_priors.html">specify_priors</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>                                           n_interior_knots <span class="op">=</span> <span class="va">n_interior_knots</span>,</span>
<span>                                           a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">D</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           b <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                           c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">D</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                           G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           e <span class="op">=</span> <span class="va">e</span>,</span>
<span>                                           f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span>                                           </span>
<span><span class="co"># Run JANE using supplied prior hyperparameters</span></span>
<span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>     initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RS"</span>,</span>
<span>     noise_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">my_prior_hyperparameters</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="parallel-implementation-of-jane">Parallel implementation of <code>JANE()</code><a class="anchor" aria-label="anchor" href="#parallel-implementation-of-jane"></a>
</h2>
<p>You can speed up fitting models for multiple combinations of cluster
number <code>K</code>, latent space dimension <code>D</code>, and number
of initializations of the EM algorithm <code>n_start</code>, by running
<code><a href="../reference/JANE.html">JANE()</a></code> in parallel. This leverages the <code>future</code>
and <code>future.apply</code> packages to distribute computation across
cores.</p>
<p>Below is an example using 5 parallel workers to run
<code><a href="../reference/JANE.html">JANE()</a></code> with parallel backend enabled, followed by resetting
to sequential processing.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up parallel plan with 5 workers (cores)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run JANE in parallel </span></span>
<span><span class="va">res_parallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>                     D <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>                     K <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                     initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>                     model <span class="op">=</span> <span class="st">"RSR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reset to sequential processing</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="case-control-implementation-of-jane">Case-control implementation of <code>JANE()</code><a class="anchor" aria-label="anchor" href="#case-control-implementation-of-jane"></a>
</h2>
<p>When working with large <em>sparse</em> networks, the case-control
approximation implemented in <code><a href="../reference/JANE.html">JANE()</a></code> can reduce
computational cost. This approach leverages approximation methods
developed by <span class="citation">Raftery et al. (2012)</span>. With
the case-control implementation, the likelihood includes all edges
(where most of the information lies) but uses a Monte Carlo
approximation of terms involving the unconnected dyads of the network
(i.e., non-edges). Thus, the cost of evaluating the likelihood becomes
linear, rather than quadratic, in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>.</p>
<p>Below is an example running <code><a href="../reference/JANE.html">JANE()</a></code> with the case-control
approach, sampling 20 controls (i.e., non-edges) per actor.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/JANE.html">JANE</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">network_adjacency_matrix</span>,</span>
<span>     D <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     initialization <span class="op">=</span> <span class="st">"GNN"</span>,</span>
<span>     model <span class="op">=</span> <span class="st">"RSR"</span>,</span>
<span>     case_control <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_control <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-s3-methods-with-jane-objects">Using S3 methods with <strong>JANE</strong> objects<a class="anchor" aria-label="anchor" href="#using-s3-methods-with-jane-objects"></a>
</h2>
<p>Once you have fit a model using the <code><a href="../reference/JANE.html">JANE()</a></code> function, you
can inspect and analyze the results using several built-in S3 methods.
These methods work with the <code>JANE</code> S3 class object returned
from a model fit.</p>
<p>For the examples in this section, we assume that <code>res</code> is
the object returned by <code><a href="../reference/JANE.html">JANE()</a></code>.</p>
<div class="section level3">
<h3 id="print">
<code>print()</code><a class="anchor" aria-label="anchor" href="#print"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method gives a summary of the optimal model
fit and available components.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p>This displays:</p>
<ul>
<li>The model type, number of clusters, and latent space dimension</li>
<li>Sizes of each cluster, that are estimated using a hard cluster
assignment rule defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>h</mi><mo stretchy="false" form="prefix">|</mo><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>h</mi></mrow><mi>U</mi></msubsup><mo>=</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>k</mi></msub><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>k</mi></mrow><mi>U</mi></msubsup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{h | \hat{Z}^{U}_{ih} = max_k \hat{Z}^{U}_{ik}\}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>k</mi></mrow><mi>U</mi></msubsup><annotation encoding="application/x-tex">\hat{Z}^{U}_{ik}</annotation></semantics></math>
is the estimated conditional probability that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
actor belongs to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">k^{th}</annotation></semantics></math>
cluster. Note, here the optimal number of clusters selected may include
empty clusters based on the hard cluster assignments</li>
<li>Available components in the fitted object <code>res</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="summary">
<code>summary()</code><a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>Use the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method to extract and display detailed
information about the estimated model.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p>You can also compare estimated cluster assignments to known true
assignments using the <code>true_labels</code> argument, or inspect
starting values using <code>initial_values = TRUE</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, true_labels <span class="op">=</span> <span class="va">true_labels_vec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span>, initial_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Output includes:</p>
<ul>
<li>Coefficients from logistic or GLM components</li>
<li>Latent positions, cluster means, and precision matrices</li>
<li>Soft cluster memberships and hard cluster assignments</li>
<li>Clustering uncertainty</li>
<li>ARI, NMI, classification error rate (if <code>true_labels</code> is
supplied)</li>
<li>Model selection criteria</li>
<li>Summary of noise edges if <code>noise_weights = TRUE</code>. This
includes the estimated conditional probability that a specific edge is a
noise or a non-noise edge, and their corresponding noise edge cluster
assignment based on a hard clustering rule of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>h</mi><mo stretchy="false" form="prefix">|</mo><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>e</mi><mi>h</mi></mrow><mi>W</mi></msubsup><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>e</mi><mn>1</mn></mrow><mi>W</mi></msubsup><mo>,</mo><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>e</mi><mn>2</mn></mrow><mi>W</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{h | \hat{Z}^{W}_{eh} = max(\hat{Z}^{W}_{e1}, \hat{Z}^{W}_{e2})\}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn><mi>…</mi><mo>,</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>E</mi><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">e = 1\dots,|E|</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>e</mi><mn>1</mn></mrow><mi>W</mi></msubsup><annotation encoding="application/x-tex">\hat{Z}^{W}_{e1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>e</mi><mn>2</mn></mrow><mi>W</mi></msubsup><annotation encoding="application/x-tex">\hat{Z}^{W}_{e2}</annotation></semantics></math>
are the estimated conditional probabilities that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">e^{th}</annotation></semantics></math>
edge is a non-noise and noise edge, respectively, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>E</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|E|</annotation></semantics></math>
represents the total number of edges in the network (for undirected
networks, only the upper diagonal edges are retained). Noise edge
cluster labels are defined as: 1 = non-noise edge and 2 = noise
edge</li>
</ul>
</div>
<div class="section level3">
<h3 id="plot">
<code>plot()</code><a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method provides visualizations depending on
the <code>type</code> argument.</p>
<div class="section level4">
<h4 id="latent-space-clustering-default-type-lsnc">Latent space clustering (default <code>type = "lsnc"</code>)<a class="anchor" aria-label="anchor" href="#latent-space-clustering-default-type-lsnc"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Plots latent positions colored by cluster</li>
<li>Contours show the fitted Gaussian components when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
= 2. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
&gt; 2, pairwise plots of the dimensions are displayed instead</li>
</ul>
</div>
<div class="section level4">
<h4 id="misclassified-actors-type-misclassified">Misclassified actors (<code>type = "misclassified"</code>)<a class="anchor" aria-label="anchor" href="#misclassified-actors-type-misclassified"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type <span class="op">=</span> <span class="st">"misclassified"</span>, true_labels <span class="op">=</span> <span class="va">true_labels_vec</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Highlights misclassified actors in black based on supplied true
cluster assignments (i.e., <code>true_labels_vec</code> in this
example)</li>
</ul>
</div>
<div class="section level4">
<h4 id="clustering-uncertainty-type-uncertainty">Clustering uncertainty (<code>type = "uncertainty"</code>)<a class="anchor" aria-label="anchor" href="#clustering-uncertainty-type-uncertainty"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type <span class="op">=</span> <span class="st">"uncertainty"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Colors nodes by uncertainty (i.e., 1 -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>k</mi></msub><msubsup><mover><mi>Z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>k</mi></mrow><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">max_k\hat{Z}^{U}_{ik}</annotation></semantics></math>)</li>
</ul>
</div>
<div class="section level4">
<h4 id="em-trace-plot-type-trace_plot">EM trace plot (<code>type = "trace_plot"</code>)<a class="anchor" aria-label="anchor" href="#em-trace-plot-type-trace_plot"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type <span class="op">=</span> <span class="st">"trace_plot"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Shows convergence metrics over EM iterations</li>
</ul>
</div>
<div class="section level4">
<h4 id="additional-options">Additional options<a class="anchor" aria-label="anchor" href="#additional-options"></a>
</h4>
<ul>
<li>
<code>alpha_edge</code>, <code>alpha_node</code>, <code>zoom</code>,
<code>swap_axes</code>, <code>rotation_angle</code>,
<code>cluster_cols</code>, etc.</li>
<li>
<code>remove_noise_edges = TRUE</code> removes noise edges based on
noise edge hard cluster assignment (only applicable if
<code><a href="../reference/JANE.html">JANE()</a></code> was run with <code>noise_weights = TRUE</code>)</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-JANE" class="csl-entry">
Arakkal, Alan T, and Daniel K Sewell. 2025. <span>“JANE: Just Another
Latent Space NEtwork Clustering Algorithm.”</span> <em>Computational
Statistics &amp; Data Analysis</em> 211: 108228.
</div>
<div id="ref-RJ-2021-048" class="csl-entry">
Bengtsson, Henrik. 2021. <span>“A Unifying Framework for Parallel and
Distributed Processing in r Using Futures.”</span> <em>The R
Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048" class="external-link">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-ICL" class="csl-entry">
Biernacki, Christophe, Gilles Celeux, and Gérard Govaert. 2000.
<span>“Assessing a Mixture Model for Clustering with the Integrated
Completed Likelihood.”</span> <em>IEEE Transactions on Pattern Analysis
and Machine Intelligence</em> 22 (7): 719–25.
</div>
<div id="ref-handcock2007model" class="csl-entry">
Handcock, Mark S, Adrian E Raftery, and Jeremy M Tantrum. 2007.
<span>“Model-Based Clustering for Social Networks.”</span> <em>Journal
of the Royal Statistical Society Series A: Statistics in Society</em>
170 (2): 301–54.
</div>
<div id="ref-Raftery2012" class="csl-entry">
Raftery, Adrian E, Xiaoyue Niu, Peter D Hoff, and Ka Yee Yeung. 2012.
<span>“Fast Inference for the Latent Space Network Model Using a
Case-Control Approximate Likelihood.”</span> <em>Journal of
Computational and Graphical Statistics</em> 21 (4): 901–19.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alan Arakkal, Daniel Sewell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
